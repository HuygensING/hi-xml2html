!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.XMLio=t():e.XMLio=t()}(this,function(){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/dist/",r(r.s=2)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),o=[":empty",":not(",":first-child",":last-child",":nth-child(",":nth-last-child",":nth-of-type",":first-of-type",":last-of-type",":only-child"];function c(e,t,r){return o.some(e=>r.slice(t,t+e.length)===e)?e:n.COLON_REPLACE}t.unwrap=function(e){return e.firstChild},t.unwrapStringFunction=function(e){return new Function(`return ${e}`)()},t.selectElements=function(e,t){t.indexOf(":")>0&&(t=t.replace(/:/gu,c));const r=e.querySelectorAll(t);return Array.from(r)},t.renameElement=function(e,t,r){const n=e.createElement(r);Array.from(t.attributes).forEach(e=>n.setAttribute(e.name,t.getAttribute(e.name))),t.className.length&&(n.className=t.className);let o=t.firstChild;for(;o;)n.appendChild(o.cloneNode(!0)),o=o.nextSibling;return n},t.replaceElement=function(e,t){null!=e.parentNode&&e.parentNode.replaceChild(t,e)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(0);function o(e){return e.replace(/:/gu,t.COLON_REPLACE)}function c(e,t){let r=0;for(;e!==t;)r+=1,e=e.parentNode;return r}t.COLON_REPLACE="_-_-_-_",t.addProxies=function(e){const t=[];for(var r=e.createTreeWalker(e,NodeFilter.SHOW_ELEMENT);r.nextNode();){const n=r.currentNode;for(const e of n.attributes){const t=e.name.indexOf(":");t>0&&"xmlns:"!==e.name.slice(0,t+1)&&n.setAttribute(o(e.name),n.getAttribute(e.name))}n.nodeName.indexOf(":")>0&&t.push({depth:c(n,e),node:n})}return t.sort((e,t)=>t.depth-e.depth).forEach(t=>{const r=n.renameElement(e,t.node,o(t.node.nodeName));n.replaceElement(t.node,r)}),e},t.removeProxies=function(e){const r=[];for(var o=e.createTreeWalker(e,NodeFilter.SHOW_ELEMENT);o.nextNode();){const n=o.currentNode;for(const e of n.attributes)e.name.indexOf(t.COLON_REPLACE)>0&&n.removeAttribute(e.name);n.nodeName.indexOf(t.COLON_REPLACE)>0&&r.push({depth:c(n,e),node:n})}return r.sort((e,t)=>t.depth-e.depth).forEach(r=>{const o=n.renameElement(e,r.node,function(e){const r=new RegExp(t.COLON_REPLACE,"ug");return e.replace(r,":")}(r.node.nodeName));n.replaceElement(r.node,o)}),e}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(3);t.handlerDefaults=n.default;const o=r(4),c=r(5),s=r(6),l=r(0),a=r(1);t.default=class{constructor(e){this.transformers=[],this.docs=[],this.createOutput=(e=>{const t=this.transformers.some(e=>"select"===e.type),r=this.docs.map(e=>a.removeProxies(e)).map(t=>{let r=e.map(e=>"xml"===e.type?s.exportAsXml(t,e):"data"===e.type?s.exportAsData(t,e):"text"===e.type?s.exportAsText(t,e):"dom"===e.type?s.exportAsDOM(t,e):void 0);return 1===r.length?r[0]:r});return t||1===r.length||console.error("Output should contain one element!"),t?r:r[0]}),e=a.addProxies(e),this.root=[e.cloneNode(!0)],this.docs=[e]}export(e){null==e?e=[n.default.xml]:(Array.isArray(e)||(e=[e]),e=e.map(e=>Object.assign({},n.default[e.type],e))),this.applyTransformers();const t=this.createOutput(e);return this.reset(),t}persist(){return this.applyTransformers(),this.root=this.docs.map(e=>e.cloneNode(!0)),this.reset(),this}addTransform(e){return e=Object.assign({},n.default[e.type],e),(0,o.default[e.type])(e)&&this.transformers.push(e),this}change(e,t){return this.addTransform({changeFunc:t,selector:e,type:"change"})}rename(e,t){return this.addTransform({newName:t,selector:e,type:"rename"})}exclude(e){return this.addTransform({selector:e,type:"exclude"})}replace(e,t,r=!0){return this.addTransform({removeSource:r,sourceSelectorFunc:t,targetSelector:e,type:"replace"})}select(e){return this.addTransform({selector:e,type:"select"})}reset(){this.transformers=[],this.docs=this.root.map(e=>e.cloneNode(!0))}applyTransformers(){this.transformers.forEach(e=>{"exclude"===e.type&&(this.docs=c.exclude(this.docs,e)),"replace"===e.type&&(this.docs=c.replace(this.docs,e)),"select"===e.type&&(this.docs=this.selectTransformer(this.docs,e)),"change"===e.type&&(this.docs=c.change(this.docs,e)),"rename"===e.type&&(this.docs=this.renameTransformer(this.docs,e))})}renameTransformer(e,t){return e.map(e=>(l.selectElements(e,t.selector).forEach(r=>{const n=l.renameElement(e,r,t.newName);l.replaceElement(r,n)}),e))}selectTransformer(e,t){return e.map(e=>l.selectElements(e,t.selector).map(t=>{const r=e.cloneNode(!0);return r.replaceChild(t,r.documentElement),r})).reduce((e,t)=>e.concat(t),[])}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={change:{active:!0,changeFunc:e=>e,selector:"",type:"change"},exclude:{active:!0,selector:[],type:"exclude"},rename:{active:!0,selector:"",newName:"",type:"rename"},replace:{active:!0,removeSource:!0,sourceSelectorFunc:()=>"",targetSelector:"",type:"replace"},select:{active:!0,selector:"",type:"select"},xml:{active:!0,type:"xml"},data:{active:!0,deep:!0,text:!0,type:"data"},text:{active:!0,join:" ",type:"text"},dom:{active:!0,type:"dom"}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={change:function(e){return e.changeFunc.length>0&&e.selector.length>0},exclude:function(e){return e.selector.length>0},rename:function(e){return e.selector.length>0&&e.newName.length>0},replace:function(e){return e.targetSelector.length>0&&e.sourceSelectorFunc.length>0},select:function(e){return e.selector.length>0}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(0),o=r(1);t.exclude=function(e,t){return e.map(e=>((Array.isArray(t.selector)?t.selector:[t.selector]).forEach(t=>{n.selectElements(e,t).forEach(e=>e.parentNode.removeChild(e))}),e))},t.change=function(e,t){return e.map(e=>{const r=n.selectElements(e,t.selector);return Array.from(r).forEach(t.changeFunc),e})},t.replace=function(e,t){return e.map(e=>(function(e,t){const r=n.selectElements(e,t.targetSelector);r.length||console.log("WARNING",`No targets found for ${t.targetSelector}`);const c=[];return Array.from(r).forEach(r=>{c.push(r);const s=t.sourceSelectorFunc(r);let l=[];if(s instanceof Node)l.push(s);else{const t=n.selectElements(e,s);l=Array.from(t).filter(e=>-1===c.indexOf(e))}if(!l.length){const e=Array.from(r.attributes).reduce((e,t)=>t.name.indexOf(o.COLON_REPLACE)>-1?e:"class"===t.name&&""===t.value?e:e+=`[${t.name}=${t.value}]`,"");return void console.log("WARNING",`No sources (${s}) found for target: ${t.targetSelector}${e}`)}let[a,...u]=l;t.removeSource||(a=a.cloneNode(!0)),c.push(a),n.replaceElement(r,a),u.length&&u.filter(e=>-1===c.indexOf(e)).forEach(e=>{t.removeSource||(e=e.cloneNode(!0)),c.push(e),a.parentNode.insertBefore(e,a.nextSibling)})}),e})(e,t))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.exportAsXml=function(e,t){return null==e?"":(new XMLSerializer).serializeToString(e)},t.exportAsData=function(e,t){function r(e){const t=Array.from(e.attributes).reduce((t,r)=>(t[r.name]=e.getAttribute(r.name),t),{});return{name:e.nodeName.toLowerCase(),attributes:t,children:[]}}if(!t.deep)return r(e.documentElement);const n=new Map,o=t.text?NodeFilter.SHOW_ALL:NodeFilter.SHOW_ELEMENT;var c=e.createTreeWalker(e.documentElement,o);const s=r(c.currentNode);for(n.set(c.currentNode,s);c.nextNode();){let e;if(1===c.currentNode.nodeType)e=r(c.currentNode),n.set(c.currentNode,e);else if(3===c.currentNode.nodeType){if(!c.currentNode.textContent.trim().length)continue;e=c.currentNode.textContent}n.get(c.currentNode.parentElement).children.push(e)}return s},t.exportAsText=function(e,t){var r=e.createTreeWalker(e,NodeFilter.SHOW_TEXT);const n=[],o=null!=r.currentNode.nodeValue?r.currentNode.nodeValue.trim():"";for(n.push(o);r.nextNode();)n.push(r.currentNode.nodeValue.trim());return n.filter(e=>null!=e&&e.length).join(t.join)},t.exportAsDOM=function(e,t){return e}}]).default});