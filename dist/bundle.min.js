!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.XMLio=t():e.XMLio=t()}(this,function(){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/dist/",r(r.s=2)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),o=[":empty",":not(",":first-child",":last-child",":nth-child(",":nth-last-child",":nth-of-type",":first-of-type",":last-of-type",":only-child"];t.wrapTree=function(e){return function(t){const r=document.createElement("section");return e.namespaces.forEach(e=>{t.setAttribute(`xmlns:${e}`,"http://example.com")}),r.appendChild(t),r}},t.unwrap=function(e){return e.firstChild},t.unwrapStringFunction=function(e){return new Function(`return ${e}`)()},t.selectElements=function(e,t){const r=t.indexOf(":");r>0&&o.every(e=>t.slice(r,r+e.length)!==e)&&(t=t.replace(/:/gsu,n.COLON_REPLACE).toLowerCase());const c=e.querySelectorAll(t);return Array.from(c)},t.renameElement=function(e,t){const r=document.createElement(t);Array.from(e.attributes).forEach(t=>r.setAttribute(t.name,e.getAttribute(t.name))),r.className=e.className;let n=e.firstChild;for(;n;)r.appendChild(n.cloneNode(!0)),n=n.nextSibling;return r},t.replaceElement=function(e,t){null!=e.parentElement&&e.parentElement.replaceChild(t,e)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(0);function o(e){return e.replace(/:/gsu,t.COLON_REPLACE)}t.COLON_REPLACE="_-_-_-_";t.default=class{constructor(e){this.parserOptions=e,this.proxyElements=new Map,this.proxyAttributeElements=[]}addProxies(e){if(!this.parserOptions.handleNamespaces)return;const t=[];for(var r=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT);r.nextNode();){const e=r.currentNode;for(const t of e.attributes){const r=t.name.indexOf(":");r>0&&"xmlns:"!==t.name.slice(0,r+1)&&(e.setAttribute(o(t.name),e.getAttribute(t.name)),this.proxyAttributeElements.push(e))}e.nodeName.indexOf(":")>0&&t.push(e)}return t.forEach(e=>{const t=n.renameElement(e,o(e.nodeName));this.proxyElements.set(t,e),n.replaceElement(e,t)}),e}removeProxies(e){return this.proxyAttributeElements.forEach(e=>{for(const r of e.attributes)r.name.indexOf(t.COLON_REPLACE)>0&&e.removeAttribute(r.name)}),Array.from(this.proxyElements.entries()).forEach(([e,t])=>{n.replaceElement(e,t)}),e}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(3),o=n.__importDefault(r(4));t.handlerDefaults=o.default;const c=n.__importDefault(r(5)),u=r(6),a=r(7),s=r(0),i=n.__importDefault(r(1));t.default=class{constructor(e,t){this.parserOptions=t,this.transformers=[],this.trees=[],this.createOutput=(e=>{const t=this.trees.map(e=>this.proxyHandler.removeProxies(e)).map(s.unwrap).map(t=>"xml"===e.type?a.exportAsXml(t,e,this.parserOptions):"data"===e.type?a.exportAsData(t,e):"text"===e.type?a.exportAsText(t,e):"dom"===e.type?a.exportAsDOM(t,e):void 0);return t.length?1===t.length?t[0]:t:null}),this.parserOptions=Object.assign({handleNamespaces:!0,namespaces:[]},t),this.proxyHandler=new i.default(this.parserOptions);let r=document.createElement("root");this.parserOptions.namespaces.forEach(e=>r.setAttribute(`xmlns:${e}`,"http://example.com")),r.appendChild(e),r=this.proxyHandler.addProxies(r),this.root=[r.cloneNode(!0)],this.trees=[r]}export(e){null==e?e=[o.default.xml]:(Array.isArray(e)||(e=[e]),e=e.map(e=>Object.assign({},o.default[e.type],e))),this.applyTransformers();let t=e.map(this.createOutput);return t=1===t.length?t[0]:t,this.reset(),t}persist(){return this.applyTransformers(),this.root=this.trees.map(e=>e.cloneNode(!0)),this.reset(),this}reset(){this.transformers=[],this.trees=this.root.map(e=>e.cloneNode(!0))}applyTransformers(){this.transformers.forEach(e=>{"exclude"===e.type&&(this.trees=u.exclude(this.trees,e)),"replace"===e.type&&(this.trees=u.replace(this.trees,e)),"select"===e.type&&(this.trees=u.select(this.trees,e,this.parserOptions)),"change"===e.type&&(this.trees=u.change(this.trees,e)),"rename"===e.type&&(this.trees=u.rename(this.trees,e))})}addTransform(e){return e=Object.assign({},o.default[e.type],e),(0,c.default[e.type])(e)&&this.transformers.push(e),this}change(e,t){return this.addTransform({changeFunc:t,selector:e,type:"change"})}rename(e,t){return this.addTransform({newName:t,selector:e,type:"rename"})}exclude(e){return this.addTransform({selector:e,type:"exclude"})}replace(e,t,r=!0){return this.addTransform({removeSource:r,sourceSelectorFunc:t,targetSelector:e,type:"replace"})}select(e){return this.addTransform({selector:e,type:"select"})}}},function(e,t,r){"use strict";r.r(t),r.d(t,"__extends",function(){return o}),r.d(t,"__assign",function(){return c}),r.d(t,"__rest",function(){return u}),r.d(t,"__decorate",function(){return a}),r.d(t,"__param",function(){return s}),r.d(t,"__metadata",function(){return i}),r.d(t,"__awaiter",function(){return l}),r.d(t,"__generator",function(){return f}),r.d(t,"__exportStar",function(){return p}),r.d(t,"__values",function(){return d}),r.d(t,"__read",function(){return m}),r.d(t,"__spread",function(){return h}),r.d(t,"__await",function(){return y}),r.d(t,"__asyncGenerator",function(){return b}),r.d(t,"__asyncDelegator",function(){return _}),r.d(t,"__asyncValues",function(){return x}),r.d(t,"__makeTemplateObject",function(){return v}),r.d(t,"__importStar",function(){return g}),r.d(t,"__importDefault",function(){return O});
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};function o(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var c=function(){return(c=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function u(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&(r[n[o]]=e[n[o]])}return r}function a(e,t,r,n){var o,c=arguments.length,u=c<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(u=(c<3?o(u):c>3?o(t,r,u):o(t,r))||u);return c>3&&u&&Object.defineProperty(t,r,u),u}function s(e,t){return function(r,n){t(r,n,e)}}function i(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function l(e,t,r,n){return new(r||(r=Promise))(function(o,c){function u(e){try{s(n.next(e))}catch(e){c(e)}}function a(e){try{s(n.throw(e))}catch(e){c(e)}}function s(e){e.done?o(e.value):new r(function(t){t(e.value)}).then(u,a)}s((n=n.apply(e,t||[])).next())})}function f(e,t){var r,n,o,c,u={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return c={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function a(c){return function(a){return function(c){if(r)throw new TypeError("Generator is already executing.");for(;u;)try{if(r=1,n&&(o=2&c[0]?n.return:c[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,c[1])).done)return o;switch(n=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return u.label++,{value:c[1],done:!1};case 5:u.label++,n=c[1],c=[0];continue;case 7:c=u.ops.pop(),u.trys.pop();continue;default:if(!(o=(o=u.trys).length>0&&o[o.length-1])&&(6===c[0]||2===c[0])){u=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){u.label=c[1];break}if(6===c[0]&&u.label<o[1]){u.label=o[1],o=c;break}if(o&&u.label<o[2]){u.label=o[2],u.ops.push(c);break}o[2]&&u.ops.pop(),u.trys.pop();continue}c=t.call(e,u)}catch(e){c=[6,e],n=0}finally{r=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,a])}}}function p(e,t){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}function d(e){var t="function"==typeof Symbol&&e[Symbol.iterator],r=0;return t?t.call(e):{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}}}function m(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,c=r.call(e),u=[];try{for(;(void 0===t||t-- >0)&&!(n=c.next()).done;)u.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=c.return)&&r.call(c)}finally{if(o)throw o.error}}return u}function h(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(m(arguments[t]));return e}function y(e){return this instanceof y?(this.v=e,this):new y(e)}function b(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,o=r.apply(e,t||[]),c=[];return n={},u("next"),u("throw"),u("return"),n[Symbol.asyncIterator]=function(){return this},n;function u(e){o[e]&&(n[e]=function(t){return new Promise(function(r,n){c.push([e,t,r,n])>1||a(e,t)})})}function a(e,t){try{(r=o[e](t)).value instanceof y?Promise.resolve(r.value.v).then(s,i):l(c[0][2],r)}catch(e){l(c[0][3],e)}var r}function s(e){a("next",e)}function i(e){a("throw",e)}function l(e,t){e(t),c.shift(),c.length&&a(c[0][0],c[0][1])}}function _(e){var t,r;return t={},n("next"),n("throw",function(e){throw e}),n("return"),t[Symbol.iterator]=function(){return this},t;function n(n,o){t[n]=e[n]?function(t){return(r=!r)?{value:y(e[n](t)),done:"return"===n}:o?o(t):t}:o}}function x(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=d(e),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise(function(n,o){(function(e,t,r,n){Promise.resolve(n).then(function(t){e({value:t,done:r})},t)})(n,o,(t=e[r](t)).done,t.value)})}}}function v(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}function g(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function O(e){return e&&e.__esModule?e:{default:e}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={change:{active:!0,changeFunc:e=>e,selector:"",type:"change"},exclude:{active:!0,selector:[],type:"exclude"},rename:{active:!0,selector:"",newName:"",type:"rename"},replace:{active:!0,removeSource:!0,sourceSelectorFunc:()=>"",targetSelector:"",type:"replace"},select:{active:!0,selector:"",type:"select"},xml:{active:!0,type:"xml"},data:{active:!0,deep:!0,text:!0,type:"data"},text:{active:!0,join:" ",type:"text"},dom:{active:!0,type:"dom"}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={change:function(e){return e.changeFunc.length>0&&e.selector.length>0},exclude:function(e){return e.selector.length>0},rename:function(e){return e.selector.length>0&&e.newName.length>0},replace:function(e){return e.targetSelector.length>0&&e.sourceSelectorFunc.length>0},select:function(e){return e.selector.length>0}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(0),o=r(1);t.exclude=function(e,t){return e.map(e=>((Array.isArray(t.selector)?t.selector:[t.selector]).forEach(t=>{n.selectElements(e,t).forEach(e=>e.parentNode.removeChild(e))}),e))},t.change=function(e,t){return e.map(e=>{const r=n.selectElements(e,t.selector);return Array.from(r).forEach(t.changeFunc),e})},t.rename=function(e,t){return e.map(e=>(n.selectElements(e,t.selector).forEach(e=>{const r=n.renameElement(e,t.newName);n.replaceElement(e,r)}),e))},t.replace=function(e,t){return e.map(e=>(function(e,t){const r=n.selectElements(e,t.targetSelector);r.length||console.log("WARNING",`No targets found for ${t.targetSelector}`);const c=[];return Array.from(r).forEach(r=>{c.push(r);const u=t.sourceSelectorFunc(r);let a=[];if(u instanceof Node)a.push(u);else{const t=n.selectElements(e,u);a=Array.from(t).filter(e=>-1===c.indexOf(e))}if(!a.length){const e=Array.from(r.attributes).reduce((e,t)=>t.name.indexOf(o.COLON_REPLACE)>-1?e:"class"===t.name&&""===t.value?e:e+=`[${t.name}=${t.value}]`,"");return void console.log("WARNING",`No sources (${u}) found for target: ${t.targetSelector}${e}`)}let[s,...i]=a;t.removeSource||(s=s.cloneNode(!0)),c.push(s),n.replaceElement(r,s),i.length&&i.filter(e=>-1===c.indexOf(e)).forEach(e=>{t.removeSource||(e=e.cloneNode(!0)),c.push(e),s.parentNode.insertBefore(e,s.nextSibling)})}),e})(e,t))},t.select=function(e,t,r){return e.map(e=>n.selectElements(e,t.selector).map(n.wrapTree(r))).reduce((e,t)=>e.concat(t),[])}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.exportAsXml=function(e,t,r){if(null==e)return"";const n=(new XMLSerializer).serializeToString(e);return r.namespaces.length||null!=e.attributes&&!Array.from(e.attributes).some(e=>/^xmlns/.test(e.name))?n.replace(/\sxmlns(:.*?)?="(.*?)"/gsu,""):n},t.exportAsData=function(e,t){function r(e){const t=e,r=Array.from(t.attributes).reduce((e,r)=>(e[r.name]=t.getAttribute(r.name),e),{});return{name:t.nodeName.toLowerCase(),attributes:r,children:[]}}if(!t.deep)return r(e);const n=new Map,o=t.text?NodeFilter.SHOW_ALL:NodeFilter.SHOW_ELEMENT;var c=document.createTreeWalker(e,o);const u=r(c.currentNode);for(n.set(c.currentNode,u);c.nextNode();){let e;if(1===c.currentNode.nodeType)e=r(c.currentNode),n.set(c.currentNode,e);else if(3===c.currentNode.nodeType){if(!c.currentNode.textContent.trim().length)continue;e=c.currentNode.textContent}n.get(c.currentNode.parentElement).children.push(e)}return u},t.exportAsText=function(e,t){var r=document.createTreeWalker(e,NodeFilter.SHOW_TEXT);const n=[],o=null!=r.currentNode.nodeValue?r.currentNode.nodeValue.trim():"";for(n.push(o);r.nextNode();)n.push(r.currentNode.nodeValue.trim());return n.filter(e=>null!=e&&e.length).join(t.join)},t.exportAsDOM=function(e,t){return e}}]).default});